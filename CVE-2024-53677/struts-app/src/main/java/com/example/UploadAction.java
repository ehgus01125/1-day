package com.struts2;

import com.opensymphony.xwork2.ActionSupport;
import java.io.*;
import java.util.ArrayList;
import java.util.List;

public class UploadAction extends ActionSupport {

    private static final long serialVersionUID = 1L;


    private File upload;
    private String uploadContentType;
    private String uploadFileName;


    public File getUpload() {
        return upload;
    }

    public void setUpload(File upload) {
        this.upload = upload;
    }

    public String getUploadContentType() {
        return uploadContentType;
    }

    public void setUploadContentType(String uploadContentType) {
        this.uploadContentType = uploadContentType;
    }

    public String getUploadFileName() {
        return uploadFileName;
    }

    public void setUploadFileName(String uploadFileName) {
        this.uploadFileName = uploadFileName;
    }


    public String doUpload() {
        if (upload != null && upload.length() > 0) {
            try {
                
                String uploadDir = "webapps/ROOT/uploads"; 
                File uploadDirectory = new File(uploadDir);
                
                if (!uploadDirectory.exists()) {
                    uploadDirectory.mkdir();
                }
    
                File destFile = new File(uploadDirectory, uploadFileName);
    
                FileInputStream inputStream = new FileInputStream(upload);
                FileOutputStream outputStream = new FileOutputStream(destFile);
    
                byte[] buffer = new byte[1024];
                int length;
                while ((length = inputStream.read(buffer)) > 0) {
                    outputStream.write(buffer, 0, length);
                }
                inputStream.close();
                outputStream.close();
                return SUCCESS;
            } catch (IOException e) {
                addActionError("File upload failed: " + e.getMessage());
                return ERROR;
            }
        } else {
            addActionError("No file uploaded.");
            return ERROR;
        }
    }

}